## 2.2 新特性

### 2.2.1 自1.4后，1.5中的变化

#### 不再支持 spring-erlang
发行版中不再包含`spring-erlang`的jar。使用<3.1.10 RabbitMQ REST API>代替。

#### CachingConnectionFactory的改变

##### CachingConnectionFactory中Addresses属性为空
之前，如果连接工厂通过一个主机/端口进行配置，但是赋值给`addresses`空字符串，主机和端口将被忽略掉。现在，一个空的`addresses`字符串被认为与`null`相同，将使用指定的主机和端口。

##### URI构造器
`CachingConnectionFactory`另外增加了一个构造器，通过`URI`参数来配置中间件连接。

##### 连接重置
添加了一个新方法`resetConnection()`，允许用户重置连接。举个例子，这可以被用作连接次中间件故障之后重新连接到主中间件。这**会**影响进程内的操作。虽然现有的`destroy()`方法是一摸一样的，但是新方法有了一个看起来不那么危险的命名。

#### 控制容器内队列声明行为的属性
当监听器容器中的消费者启动时，会尝试被动地声明那些队列来确保它们在中间件上是可用的。以前，如果这些声明失败了，比如因为队列不存在，或者当一个HA队列被移除，重试逻辑定义为重试3次中间5秒间隔。如果队列仍然不存在，那行为会由`missingQueuesFatal`属性（默认为true）来控制。
而且，对于配置了监听多个队列的容器，如果只有其中一部分队列可用，那些不存在的队列消费者会以60秒的固定间隔重试。  
现在，这3个属性（`declarationRetries`，`failedDeclarationRetryInterval`，`retryDeclarationInterval`）都是可配置的了。更多信息可参见<3.1.13 Message Listener Container Configuration>。

#### 类所属包变更
`RabbitGatewaySupport`类从`o.s.amqp.rabbit.core.support`中移动到了`o.s.amqp.rabbit.core`中。

#### DefaultMessagePropertiesConverter
`DefaultMessagePropertiesConverter`现在可以通过配置定义`LongString`转化为`String`而不是`DataInputStream`的最大长度。该转化器有一个可选的构造方法来获取这个值作为限制。之前这个限制被硬编码为`1024`bytes。（*1.4.4*中也可用）。

#### @RabbitListener改进

##### @RabbitListener的@QueueBinding
@RabbitListener注解增加了和`queues`属性互斥的`bindings`属性，用以允许对`queue`的指定，它的`exchange`和`binding`在中间件上通过`RabbitAdmin`声明。

##### @SendTo中的SpEL
`@RabbitListener`上的默认回复地址（`@SendTo`）现在可以是一个SpEL表达式。


